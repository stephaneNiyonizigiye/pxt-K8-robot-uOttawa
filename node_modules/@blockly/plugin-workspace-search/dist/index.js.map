{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@blockly/plugin-workspace-search/webpack/universalModuleDefinition","webpack://@blockly/plugin-workspace-search/external umd {\"root\":\"Blockly\",\"commonjs\":\"blockly/core\",\"commonjs2\":\"blockly/core\",\"amd\":\"blockly/core\"}","webpack://@blockly/plugin-workspace-search/webpack/bootstrap","webpack://@blockly/plugin-workspace-search/webpack/runtime/define property getters","webpack://@blockly/plugin-workspace-search/webpack/runtime/hasOwnProperty shorthand","webpack://@blockly/plugin-workspace-search/webpack/runtime/make namespace object","webpack://@blockly/plugin-workspace-search/./src/css.ts","webpack://@blockly/plugin-workspace-search/./src/workspace_search.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"blockly/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"blockly/core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"blockly/core\")) : factory(root[\"Blockly\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, (__WEBPACK_EXTERNAL_MODULE__370__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__370__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Styling for workspace search.\n * @author aschmiedt@google.com (Abby Schmiedt)\n * @author kozbial@google.com (Monica Kozbial)\n */\n\n/**\n * Base64 encoded data uri for close icon.\n */\nconst closeSvgDataUri =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC' +\n  '9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aC' +\n  'BkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNS' +\n  'AxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPj' +\n  'xwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=';\n\n/**\n * Base64 encoded data uri for keyboard arrow down icon.\n */\nconst arrowDownSvgDataUri =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC' +\n  '9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aC' +\n  'BkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLT' +\n  'EuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+';\n\n/**\n * Base64 encoded data uri for keyboard arrow up icon.\n */\nconst arrowUpSvgDataUri =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC' +\n  '9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aC' +\n  'BkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PH' +\n  'BhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==';\n\n/**\n * CSS for workspace search.\n */\nconst cssContent = `path.blocklyPath.blockly-ws-search-highlight {\n    fill: #000;\n  }\n  path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {\n    fill: grey;\n  }\n  .blockly-ws-search-close-btn {\n    background: url(${closeSvgDataUri}) no-repeat top left;\n  }\n  .blockly-ws-search-next-btn {\n    background: url(${arrowDownSvgDataUri}) no-repeat top left;\n  }\n  .blockly-ws-search-previous-btn {\n    background: url(${arrowUpSvgDataUri}) no-repeat top left;\n  }\n  .blockly-ws-search {\n    background: #fff;\n    border: solid lightgrey 0.5px;\n    box-shadow: 0px 10px 20px grey;\n    justify-content: center;\n    padding: 0.25em;\n    position: absolute;\n    z-index: 70;\n  }\n  .blockly-ws-search-input input {\n    border: none;\n  }\n  .blockly-ws-search button {\n    border: none;\n    padding-left: 6px;\n    padding-right: 6px;\n  }\n  .blockly-ws-search-actions {\n    display: flex;\n  }\n  .blockly-ws-search-container {\n    display: flex;\n  }\n  .blockly-ws-search-content {\n    display: flex;\n  }`;\n\n/**\n * Injects CSS for workspace search.\n */\nexport const injectSearchCss = (function () {\n  let executed = false;\n  return function () {\n    // Only inject the CSS once.\n    if (executed) {\n      return;\n    }\n    executed = true;\n    // Inject CSS tag at start of head.\n    const cssNode = document.createElement('style');\n    cssNode.id = 'blockly-ws-search-style';\n    const cssTextNode = document.createTextNode(cssContent);\n    cssNode.appendChild(cssTextNode);\n    document.head.insertBefore(cssNode, document.head.firstChild);\n  };\n})();\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as Blockly from 'blockly/core';\n\nimport {injectSearchCss} from './css';\n\n/**\n * Class for workspace search.\n */\nexport class WorkspaceSearch implements Blockly.IPositionable {\n  /**\n   * The unique id for this component.\n   */\n  id = 'workspaceSearch';\n\n  /**\n   * HTML container for the search bar.\n   */\n  private htmlDiv: HTMLElement | null = null;\n\n  /**\n   * The div that holds the search bar actions.\n   */\n  protected actionDiv: HTMLElement | null = null;\n\n  /**\n   * The text input for the search bar.\n   */\n  private inputElement: HTMLInputElement | null = null;\n\n  /**\n   * The placeholder text for the search bar input.\n   */\n  private textInputPlaceholder = 'Search';\n\n  /**\n   * A list of blocks that came up in the search.\n   */\n  protected blocks: Blockly.BlockSvg[] = [];\n\n  /**\n   * The last highlighted block, which we focus on close.\n   *\n   * This block is focused on close even if the most recent search found nothing\n   * because we've centered on it and it's helpful for focus to be in sync with\n   * the scroll position.\n   */\n  private lastHighlighted: Blockly.BlockSvg | null = null;\n\n  /**\n   * Index of the currently \"selected\" block in the blocks array.\n   */\n  protected currentBlockIndex = -1;\n\n  /**\n   * The search text.\n   */\n  protected searchText = '';\n\n  /**\n   * Whether to search as input changes as opposed to on enter.\n   */\n  searchOnInput = true;\n\n  /**\n   * Whether search should be case sensitive.\n   */\n  caseSensitive = false;\n\n  /**\n   * Whether search should preserve the currently selected block by default.\n   */\n  preserveSelected = true;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   */\n  private boundEvents: Blockly.browserEvents.Data[] = [];\n\n  /**\n   * Class for workspace search.\n   *\n   * @param workspace The workspace the search bar sits in.\n   */\n  constructor(private workspace: Blockly.WorkspaceSvg) {}\n\n  /**\n   * Initializes the workspace search bar.\n   */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 0,\n      capabilities: [Blockly.ComponentManager.Capability.POSITIONABLE],\n    });\n    injectSearchCss();\n    this.createDom();\n    this.setVisible(false);\n\n    this.workspace.resize();\n  }\n\n  /**\n   * Disposes of workspace search.\n   * Unlink from all DOM elements and remove all event listeners\n   * to prevent memory leaks.\n   */\n  dispose() {\n    for (const event of this.boundEvents) {\n      Blockly.browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    if (this.htmlDiv) {\n      this.htmlDiv.remove();\n      this.htmlDiv = null;\n    }\n    this.actionDiv = null;\n    this.inputElement = null;\n  }\n\n  /**\n   * Creates and injects the search bar's DOM.\n   */\n  protected createDom() {\n    /*\n     * Creates the search bar. The generated search bar looks like:\n     * <div class=\"ws-search'>\n     *   <div class=\"ws-search-container'>\n     *     <div class=\"ws-search-content'>\n     *       <div class=\"ws-search-input'>\n     *         [... text input goes here ...]\n     *       </div>\n     *       [... actions div goes here ...]\n     *     </div>\n     *     [... close button goes here ...]\n     *   </div>\n     * </div>\n     */\n    const injectionDiv = this.workspace.getInjectionDiv();\n    this.addEvent(injectionDiv, 'keydown', this, (evt: KeyboardEvent) =>\n      this.onWorkspaceKeyDown(evt),\n    );\n\n    this.htmlDiv = document.createElement('div');\n    Blockly.utils.dom.addClass(this.htmlDiv, 'blockly-ws-search');\n\n    const searchContainer = document.createElement('div');\n    Blockly.utils.dom.addClass(searchContainer, 'blockly-ws-search-container');\n\n    const searchContent = document.createElement('div');\n    Blockly.utils.dom.addClass(searchContent, 'blockly-ws-search-content');\n    searchContainer.appendChild(searchContent);\n\n    const inputWrapper = document.createElement('div');\n    Blockly.utils.dom.addClass(inputWrapper, 'blockly-ws-search-input');\n    this.inputElement = this.createTextInput();\n    this.addEvent(this.inputElement, 'keydown', this, (evt: KeyboardEvent) =>\n      this.onKeyDown(evt),\n    );\n    this.addEvent(this.inputElement, 'input', this, () => this.onInput());\n    this.addEvent(this.inputElement, 'click', this, () => {\n      this.searchAndHighlight(this.searchText, this.preserveSelected);\n      this.inputElement?.select();\n    });\n\n    inputWrapper.appendChild(this.inputElement);\n    searchContent.appendChild(inputWrapper);\n\n    this.actionDiv = document.createElement('div');\n    Blockly.utils.dom.addClass(this.actionDiv, 'blockly-ws-search-actions');\n    searchContent.appendChild(this.actionDiv);\n\n    const nextBtn = this.createNextBtn();\n    if (nextBtn) {\n      this.addActionBtn(nextBtn, () => this.next());\n    }\n\n    const previousBtn = this.createPreviousBtn();\n    if (previousBtn) {\n      this.addActionBtn(previousBtn, () => this.previous());\n    }\n\n    const closeBtn = this.createCloseBtn();\n    if (closeBtn) {\n      this.addBtnListener(closeBtn, () => this.close());\n      searchContainer.appendChild(closeBtn);\n    }\n\n    this.htmlDiv.appendChild(searchContainer);\n\n    injectionDiv.insertBefore(this.htmlDiv, this.workspace.getParentSvg());\n  }\n\n  /**\n   * Helper method for adding an event.\n   *\n   * @param node Node upon which to listen.\n   * @param name Event name to listen to (e.g. 'mousedown').\n   * @param thisObject The value of 'this' in the function.\n   * @param func Function to call when event is triggered.\n   */\n  private addEvent<T extends Event>(\n    node: Element,\n    name: string,\n    thisObject: object,\n    func: (event: T) => void,\n  ) {\n    const event = Blockly.browserEvents.conditionalBind(\n      node,\n      name,\n      thisObject,\n      func,\n    );\n    this.boundEvents.push(event);\n  }\n\n  /**\n   * Add a button to the action div. This must be called after the init function\n   * has been called.\n   *\n   * @param btn The button to add the event listener to.\n   * @param onClickFn The function to call when the user clicks on\n   *     or hits enter on the button.\n   */\n  addActionBtn(btn: HTMLButtonElement, onClickFn: () => void) {\n    this.addBtnListener(btn, onClickFn);\n    this.actionDiv?.appendChild(btn);\n  }\n\n  /**\n   * Creates the text input for the search bar.\n   *\n   * @returns A text input for the search bar.\n   */\n  protected createTextInput(): HTMLInputElement {\n    const textInput = document.createElement('input');\n    textInput.type = 'text';\n    textInput.setAttribute('placeholder', this.textInputPlaceholder);\n    return textInput;\n  }\n\n  /**\n   * Creates the button used to get the next block in the list.\n   *\n   * @returns The next button.\n   */\n  protected createNextBtn(): HTMLButtonElement {\n    return this.createBtn('blockly-ws-search-next-btn', 'Find next');\n  }\n\n  /**\n   * Creates the button used to get the previous block in the list.\n   *\n   * @returns The previous button.\n   */\n  protected createPreviousBtn(): HTMLButtonElement {\n    return this.createBtn('blockly-ws-search-previous-btn', 'Find previous');\n  }\n\n  /**\n   * Creates the button used for closing the search bar.\n   *\n   * @returns A button for closing the search bar.\n   */\n  protected createCloseBtn(): HTMLButtonElement {\n    return this.createBtn('blockly-ws-search-close-btn', 'Close search bar');\n  }\n\n  /**\n   * Creates a button for the workspace search bar.\n   *\n   * @param className The class name for the button.\n   * @param text The text to display to the screen reader.\n   * @returns The created button.\n   */\n  private createBtn(className: string, text: string): HTMLButtonElement {\n    // Create the button\n    const btn = document.createElement('button');\n    Blockly.utils.dom.addClass(btn, className);\n    btn.setAttribute('aria-label', text);\n    return btn;\n  }\n\n  /**\n   * Add event listener for clicking and keydown on the given button.\n   *\n   * @param btn The button to add the event listener to.\n   * @param onClickFn The function to call when the user clicks on\n   *      or hits enter on the button.\n   */\n  private addBtnListener(\n    btn: HTMLButtonElement,\n    onClickFn: (e: Event) => void,\n  ) {\n    this.addEvent(btn, 'click', this, onClickFn);\n    // TODO: Review Blockly's key handling to see if there is a way to avoid\n    //  needing to call stopPropogation().\n    this.addEvent(btn, 'keydown', this, (e: KeyboardEvent) => {\n      if (e.key === 'Enter') {\n        onClickFn(e);\n        e.preventDefault();\n      } else if (e.key === 'Escape') {\n        this.close();\n      }\n      e.stopPropagation();\n    });\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The componentâ€™s bounding box. Null in this\n   *     case since we don't need other elements to avoid the workspace search\n   *     field.\n   */\n  getBoundingRectangle(): Blockly.utils.Rect | null {\n    return null;\n  }\n\n  /**\n   * Positions the workspace search field.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that\n   *     are already on the workspace.\n   */\n  position(\n    metrics: Blockly.MetricsManager.UiMetrics,\n    savedPositions: Blockly.utils.Rect[],\n  ) {\n    if (!this.htmlDiv) return;\n    if (this.workspace.RTL) {\n      this.htmlDiv.style.left = metrics.absoluteMetrics.left + 'px';\n    } else {\n      if (metrics.toolboxMetrics.position === Blockly.TOOLBOX_AT_RIGHT) {\n        this.htmlDiv.style.right = metrics.toolboxMetrics.width + 'px';\n      } else {\n        this.htmlDiv.style.right = '0';\n      }\n    }\n    this.htmlDiv.style.top = metrics.absoluteMetrics.top + 'px';\n  }\n\n  /**\n   * Handles input value change in search bar.\n   */\n  private onInput() {\n    if (this.searchOnInput && this.inputElement) {\n      const inputValue = this.inputElement.value.trim();\n      if (inputValue !== this.searchText) {\n        this.searchAndHighlight(inputValue, this.preserveSelected);\n      }\n    }\n  }\n\n  /**\n   * Handles a key down for the search bar.\n   *\n   * @param e The key down event.\n   */\n  private onKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Escape') {\n      this.close();\n    } else if (e.key === 'Enter') {\n      if (this.searchOnInput) {\n        if (e.shiftKey) {\n          this.previous();\n        } else {\n          this.next();\n        }\n      } else {\n        if (!this.inputElement) return;\n        const inputValue = this.inputElement.value.trim();\n        if (inputValue !== this.searchText) {\n          this.searchAndHighlight(inputValue, this.preserveSelected);\n        }\n      }\n    }\n  }\n\n  /**\n   * Opens the search bar when Control F or Command F are used on the workspace.\n   *\n   * @param e The key down event.\n   */\n  private onWorkspaceKeyDown(e: KeyboardEvent) {\n    // TODO: Look into handling keyboard shortcuts on workspace in Blockly.\n    if ((e.ctrlKey || e.metaKey) && e.key === 'f') {\n      this.open();\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Selects the previous block.\n   */\n  previous() {\n    this.setCurrentBlock(this.currentBlockIndex - 1);\n  }\n\n  /**\n   * Selects the next block.\n   */\n  next() {\n    this.setCurrentBlock(this.currentBlockIndex + 1);\n  }\n\n  /**\n   * Sets the placeholder text for the search bar text input.\n   *\n   * @param placeholderText The placeholder text.\n   */\n  setSearchPlaceholder(placeholderText: string) {\n    this.textInputPlaceholder = placeholderText;\n    if (this.inputElement) {\n      this.inputElement.setAttribute('placeholder', this.textInputPlaceholder);\n    }\n  }\n\n  /**\n   * Changes the currently \"selected\" block and adds extra highlight.\n   *\n   * @param index Index of block to set as current. Number is wrapped.\n   */\n  protected setCurrentBlock(index: number) {\n    if (!this.blocks.length) {\n      return;\n    }\n    let currentBlock = this.blocks[this.currentBlockIndex];\n    if (currentBlock) {\n      this.unhighlightCurrentSelection(currentBlock);\n    }\n    this.currentBlockIndex =\n      ((index % this.blocks.length) + this.blocks.length) % this.blocks.length;\n    currentBlock = this.blocks[this.currentBlockIndex];\n\n    this.highlightCurrentSelection(currentBlock);\n    this.workspace.centerOnBlock(currentBlock.id, false);\n    this.lastHighlighted = currentBlock;\n  }\n\n  /**\n   * Opens the search bar.\n   */\n  open() {\n    this.setVisible(true);\n    this.inputElement?.focus();\n    this.inputElement?.select();\n    if (this.searchText) {\n      this.searchAndHighlight(this.searchText);\n    }\n  }\n\n  /**\n   * Closes the search bar.\n   */\n  close() {\n    this.setVisible(false);\n    const focusManager = Blockly.FocusManager.getFocusManager();\n    if (this.lastHighlighted && !this.lastHighlighted.isDisposed()) {\n      focusManager.focusNode(this.lastHighlighted);\n    } else {\n      focusManager.focusTree(this.workspace);\n    }\n    this.clearBlocks();\n    this.lastHighlighted = null;\n  }\n\n  /**\n   * Shows or hides the workspace search bar.\n   *\n   * @param show Whether to set the search bar as visible.\n   */\n  private setVisible(show: boolean) {\n    if (this.htmlDiv) {\n      this.htmlDiv.style.display = show ? 'flex' : 'none';\n    }\n  }\n\n  /**\n   * Searches the workspace for the current search term and highlights matching\n   * blocks.\n   *\n   * @param searchText The search text.\n   * @param preserveCurrent Whether to preserve the current block\n   *    if it is included in the new matching blocks.\n   */\n  searchAndHighlight(searchText: string, preserveCurrent?: boolean) {\n    const oldCurrentBlock = this.blocks[this.currentBlockIndex];\n    this.searchText = searchText.trim();\n    this.clearBlocks();\n    this.blocks = this.getMatchingBlocks(\n      this.workspace,\n      this.searchText,\n      this.caseSensitive,\n    );\n    this.highlightSearchGroup(this.blocks);\n    let currentIdx = 0;\n    if (preserveCurrent) {\n      currentIdx = this.blocks.indexOf(oldCurrentBlock);\n      currentIdx = currentIdx > -1 ? currentIdx : 0;\n    }\n    this.setCurrentBlock(currentIdx);\n  }\n\n  /**\n   * Returns pool of blocks to search from.\n   *\n   * @param workspace The workspace to get blocks from.\n   * @returns The search pool of blocks to use.\n   */\n  private getSearchPool(workspace: Blockly.WorkspaceSvg): Blockly.BlockSvg[] {\n    const blocks = workspace.getAllBlocks(true);\n    return blocks.filter((block) => {\n      // Filter out blocks contained inside of another collapsed block.\n      const surroundParent = block.getSurroundParent();\n      return !surroundParent || !surroundParent.isCollapsed();\n    });\n  }\n\n  /**\n   * Returns whether the given block matches the search text.\n   *\n   * @param block The block to check.\n   * @param searchText The search text. Note if the search is case\n   *    insensitive, this will be passed already converted to lowercase letters.\n   * @param caseSensitive Whether the search is caseSensitive.\n   * @returns True if the block is a match, false otherwise.\n   */\n  protected isBlockMatch(\n    block: Blockly.BlockSvg,\n    searchText: string,\n    caseSensitive: boolean,\n  ): boolean {\n    let blockText = '';\n    if (block.isCollapsed()) {\n      // Search the whole string for collapsed blocks.\n      blockText = block.toString();\n    } else {\n      const topBlockText: string[] = [];\n      block.inputList.forEach((input) => {\n        input.fieldRow.forEach((field) => {\n          topBlockText.push(field.getText());\n        });\n      });\n      blockText = topBlockText.join(' ').trim();\n    }\n    if (!caseSensitive) {\n      blockText = blockText.toLowerCase();\n    }\n    return blockText.indexOf(searchText) > -1;\n  }\n\n  /**\n   * Returns blocks that match the given search text.\n   *\n   * @param workspace The workspace to search.\n   * @param searchText The search text.\n   * @param caseSensitive Whether the search should be case sensitive.\n   * @returns The blocks that match the search\n   *    text.\n   */\n  protected getMatchingBlocks(\n    workspace: Blockly.WorkspaceSvg,\n    searchText: string,\n    caseSensitive: boolean,\n  ): Blockly.BlockSvg[] {\n    if (!searchText) {\n      return [];\n    }\n    if (!this.caseSensitive) {\n      searchText = searchText.toLowerCase();\n    }\n    const searchGroup = this.getSearchPool(workspace);\n    return searchGroup.filter((block) =>\n      this.isBlockMatch(block, searchText, caseSensitive),\n    );\n  }\n\n  /**\n   * Clears the selection group and current block.\n   */\n  clearBlocks() {\n    this.unhighlightSearchGroup(this.blocks);\n    const currentBlock = this.blocks[this.currentBlockIndex];\n    if (currentBlock) {\n      this.unhighlightCurrentSelection(currentBlock);\n    }\n    this.currentBlockIndex = -1;\n    this.blocks = [];\n  }\n\n  /**\n   * Adds \"current selection\" highlight to the provided block.\n   * Highlights the provided block as the \"current selection\".\n   *\n   * @param currentBlock The block to highlight.\n   */\n  protected highlightCurrentSelection(currentBlock: Blockly.BlockSvg) {\n    const path = currentBlock.pathObject.svgPath;\n    Blockly.utils.dom.addClass(path, 'blockly-ws-search-current');\n  }\n\n  /**\n   * Removes \"current selection\" highlight from provided block.\n   *\n   * @param currentBlock The block to unhighlight.\n   */\n  protected unhighlightCurrentSelection(currentBlock: Blockly.BlockSvg) {\n    const path = currentBlock.pathObject.svgPath;\n    Blockly.utils.dom.removeClass(path, 'blockly-ws-search-current');\n  }\n\n  /**\n   * Adds highlight to the provided blocks.\n   *\n   * @param blocks The blocks to highlight.\n   */\n  protected highlightSearchGroup(blocks: Blockly.BlockSvg[]) {\n    blocks.forEach((block) => {\n      const blockPath = block.pathObject.svgPath;\n      Blockly.utils.dom.addClass(blockPath, 'blockly-ws-search-highlight');\n    });\n  }\n\n  /**\n   * Removes highlight from the provided blocks.\n   *\n   * @param blocks The blocks to unhighlight.\n   */\n  protected unhighlightSearchGroup(blocks: Blockly.BlockSvg[]) {\n    blocks.forEach((block) => {\n      const blockPath = block.pathObject.svgPath;\n      Blockly.utils.dom.removeClass(blockPath, 'blockly-ws-search-highlight');\n    });\n  }\n}\n"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE__370__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","injectSearchCss","executed","cssNode","document","createElement","id","cssTextNode","createTextNode","appendChild","head","insertBefore","firstChild","WorkspaceSearch","constructor","workspace","htmlDiv","actionDiv","inputElement","textInputPlaceholder","blocks","lastHighlighted","currentBlockIndex","searchText","searchOnInput","caseSensitive","preserveSelected","boundEvents","init","getComponentManager","addComponent","component","weight","capabilities","Capability","POSITIONABLE","createDom","setVisible","resize","dispose","event","unbind","length","remove","injectionDiv","getInjectionDiv","addEvent","evt","onWorkspaceKeyDown","dom","addClass","searchContainer","searchContent","inputWrapper","createTextInput","onKeyDown","onInput","searchAndHighlight","select","nextBtn","createNextBtn","addActionBtn","next","previousBtn","createPreviousBtn","previous","closeBtn","createCloseBtn","addBtnListener","close","getParentSvg","node","name","thisObject","func","conditionalBind","push","btn","onClickFn","textInput","type","setAttribute","createBtn","className","text","e","preventDefault","stopPropagation","getBoundingRectangle","position","metrics","savedPositions","RTL","style","left","absoluteMetrics","toolboxMetrics","right","width","top","inputValue","trim","shiftKey","ctrlKey","metaKey","open","setCurrentBlock","setSearchPlaceholder","placeholderText","index","currentBlock","unhighlightCurrentSelection","highlightCurrentSelection","centerOnBlock","focus","focusManager","getFocusManager","isDisposed","focusNode","focusTree","clearBlocks","show","display","preserveCurrent","oldCurrentBlock","getMatchingBlocks","highlightSearchGroup","currentIdx","indexOf","getSearchPool","getAllBlocks","filter","block","surroundParent","getSurroundParent","isCollapsed","isBlockMatch","blockText","toString","topBlockText","inputList","forEach","input","fieldRow","field","getText","join","toLowerCase","unhighlightSearchGroup","path","pathObject","svgPath","removeClass","blockPath"],"sourceRoot":""}